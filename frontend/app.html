<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Poster & Video Generator</title>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&
    family=Noto+Sans+Tamil:wght@400;700&
    family=Noto+Sans+Telugu:wght@400;700&
    family=Noto+Sans+Devanagari:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #111;
            color: #f1f1f1;
            padding: 20px;
        }
        h2 {
            color: #4fc3f7;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        input, textarea, select, button {
            margin-top: 5px;
            padding: 5px;
            border-radius: 4px;
            border: none;
        }
        input[type="color"], input[type="number"], select {
            padding: 4px;
        }
        button {
            background-color: #2196f3;
            color: white;
            padding: 8px 14px;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 5px;
        }
        button:hover {
            background-color: #1976d2;
        }
        hr {
            margin: 40px 0;
            border: 1px solid #333;
        }
        .slider-label {
            margin-right: 10px;
        }
    </style>
</head>
<body>

<h2>Poster Generator</h2>

<label>Background Image:</label>
<input type="file" id="bgUpload" accept="image/*"><br><br>

<label>Bottom Image:</label>
<input type="file" id="bottomUpload" accept="image/*"><br><br>

<label>Header Text:</label>
<textarea id="headerText" rows="2" cols="50"></textarea><br><br>

<label>Content Text:</label>
<textarea id="contentText" rows="6" cols="50"></textarea><br><br>

<label>Font:</label>
<select id="fontSelect">
    <option value="Noto Sans">English</option>
    <option value="Noto Sans Tamil">Tamil</option>
    <option value="Noto Sans Telugu">Telugu</option>
    <option value="Noto Sans Devanagari">Hindi</option>
</select><br><br>

<label>Header Color:</label>
<input type="color" id="headerColor" value="#FFFFFF"><br><br>

<label>Content Color:</label>
<input type="color" id="contentColor" value="#FFFFFF"><br><br>

<label>Header Font Size:</label>
<input type="number" id="headerSize" value="120"><br><br>

<label>Underline Header:</label>
<input type="checkbox" id="underlineHeader"><br><br>

<label>Content Font Size:</label>
<input type="number" id="contentSize" value="70"><br><br>

<label>Line Spacing:</label>
<input type="number" id="lineSpacing" value="90"><br><br>

<button onclick="generatePoster()">Generate Poster</button>

<canvas id="posterCanvas" width="1080" height="1920" style="display:none;"></canvas>

<script src="poster-script.js"></script>

<hr>

<h2>Generate Video</h2>

<label>Poster Image:</label>
<input type="file" id="posterFile" accept="image/*"><br><br>

<label>Background Music:</label>
<input type="file" id="bgMusic" accept="audio/*"><br><br>

<!-- üéöÔ∏è Background Music Volume Control -->
<label class="slider-label">Background Music Volume:</label>
<input type="range" id="musicVolume" min="10" max="100" value="30"
       style="width:200px; vertical-align:middle;"
       oninput="updateVolumeLabel(this.value)">
<span id="volumeValue">30%</span><br><br>

<label>Voice Over (Optional):</label>
<input type="file" id="voiceOver" accept="audio/*"><br><br>

<button onclick="uploadVideo()">Generate Video</button>

<script>
function updateVolumeLabel(val) {
    document.getElementById("volumeValue").innerText = val + "%";
}

async function uploadVideo() {
    const form = new FormData();
    const poster = document.getElementById("posterFile").files[0];

    if (!poster) {
        alert("Please select a poster image!");
        return;
    }

    form.append("poster", poster);

    const bg = document.getElementById("bgMusic").files[0];
    const voice = document.getElementById("voiceOver").files[0];
    const volume = document.getElementById("musicVolume").value;

    if (bg) form.append("bg_music", bg);
    if (voice) form.append("voice_over", voice);
    form.append("music_volume", volume);

    const API_URL = "https://youtubeshorts-backend-production.up.railway.app/api/generate_video";

    try {
        // Show loading alert
        alert("üé¨ Generating video... Please wait 10‚Äì20 seconds.");

        let res = await fetch(API_URL, { method: "POST", body: form });

        if (!res.ok) {
            alert("‚ùå Server error: " + res.status);
            return;
        }

        let blob = await res.blob();
        let link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "final_video.mp4";
        link.click();

        alert("‚úÖ Video generated successfully!");
    } catch (err) {
        alert("Error: " + err.message);
    }
}
</script>

</body>
</html>
